<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pusheen's Comics</title>
  <style>
    :root {
      --bg:#fffafc;
      --card:#ffffff;
      --accent:#ffb6c1;
      --text:#333;
      --gap:16px;
    }
    body {
      margin:0;
      font-family:'Comic Sans MS','Segoe UI',cursive;
      background:var(--bg);
      color:var(--text);
    }
    header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:12px 20px;
      background:#ffe4ec;
      position:sticky;
      top:0;
      z-index:20;
    }
    header h1 {
      margin:0;
      font-size:1.5rem;
      color:#ff69b4;
    }
    header button {
      background:var(--accent);
      border:none;
      border-radius:8px;
      padding:6px 14px;
      font-size:1rem;
      cursor:pointer;
    }
    .wrap {max-width:960px;margin:0 auto;padding:20px}
    .gallery {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
      gap:var(--gap);
    }
    .card {
      background:var(--card);
      border-radius:16px;
      overflow:hidden;
      box-shadow:0 4px 10px rgba(0,0,0,.15);
      cursor:pointer;
      transition:transform .2s;
    }
    .card:hover {transform:translateY(-4px)}
    .card img {width:100%;display:block}
    .caption {text-align:center;padding:8px;color:#555}

    /* Lightbox */
    .lightbox {
      position:fixed;inset:0;display:none;
      background:rgba(0,0,0,.7);
      z-index:30;
      justify-content:center;align-items:center;
    }
    .lightbox.visible {display:flex}
    .lightbox-content {
      background:#fff;
      border-radius:16px;
      max-width:90%;
      max-height:90%;
      display:flex;
      flex-direction:row;
      overflow:hidden;
    }
    .lightbox img {
      max-width:60vw;
      max-height:90vh;
      object-fit:contain;
      background:#000;
    }
    .comments {
      width:280px;
      padding:12px;
      overflow-y:auto;
      background:#fafafa;
    }
    .comments h3 {
      margin-top:0;
      font-size:1.1rem;
      color:#ff69b4;
    }
    .comment {
      background:#fff;
      padding:6px 8px;
      border-radius:8px;
      margin:6px 0;
      font-size:.9rem;
    }
    .comment .author {font-weight:bold;color:#333}
    .comment .text {margin:2px 0}
    .new-comment textarea {
      width:100%;min-height:60px;
      border:1px solid #ccc;
      border-radius:8px;
      padding:6px;
      resize:vertical;
    }
    .new-comment button {
      margin-top:6px;
      background:var(--accent);
      border:none;
      border-radius:6px;
      padding:6px 10px;
      cursor:pointer;
    }

    /* Login modal */
    .modal {
      position:fixed;inset:0;
      background:rgba(0,0,0,.5);
      display:none;
      justify-content:center;align-items:center;
      z-index:50;
    }
    .modal.visible {display:flex}
    .modal-content {
      background:#fff;
      padding:20px;
      border-radius:12px;
      width:300px;
      text-align:center;
    }
    .modal-content input {
      width:90%;
      padding:8px;
      margin:10px 0;
      border:1px solid #ccc;
      border-radius:8px;
    }
    .modal-content button {
      background:var(--accent);
      border:none;
      border-radius:8px;
      padding:8px 14px;
      cursor:pointer;
    }

    /* Responsive */
    @media (max-width:600px){
      .gallery{grid-template-columns:repeat(2,1fr)}
      .lightbox-content{flex-direction:column;max-height:95%}
      .lightbox img{max-width:100%;max-height:60vh}
      .comments{width:100%;max-height:35vh}
      .modal-content{width:90%;max-width:350px}
      .modal-content input,.modal-content button{font-size:1.2rem}
    }
  </style>
</head>
<body>
  <header>
    <h1>Pusheen's Comics</h1>
    <div>
      <button id="signinBtn">Sign in</button>
      <button id="logoutBtn" style="display:none">Logout</button>
    </div>
  </header>

  <div class="wrap">
    <main>
      <div id="gallery" class="gallery"></div>
    </main>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox">
    <div class="lightbox-content">
      <img id="lightboxImg" src="" alt="">
      <div class="comments">
        <h3 id="commentHeader">Comments</h3>
        <div id="commentList"></div>
        <div class="new-comment">
          <textarea id="commentText" placeholder="Write a comment..."></textarea>
          <button id="postBtn">Post</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Login modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <h2>Sign in</h2>
      <input type="text" id="username" placeholder="Enter a nickname"/>
      <button id="loginBtn">Login</button>
    </div>
  </div>

  <script>
    const MAX_IMAGES=100;
    const galleryEl=document.getElementById('gallery');
    const lightbox=document.getElementById('lightbox');
    const lightboxImg=document.getElementById('lightboxImg');
    const commentList=document.getElementById('commentList');
    const commentText=document.getElementById('commentText');
    const postBtn=document.getElementById('postBtn');
    const commentHeader=document.getElementById('commentHeader');

    const loginModal=document.getElementById('loginModal');
    const signinBtn=document.getElementById('signinBtn');
    const logoutBtn=document.getElementById('logoutBtn');
    const loginBtn=document.getElementById('loginBtn');
    const usernameInput=document.getElementById('username');

    let currentImage=null;
    let currentUser=localStorage.getItem('pusheen_user')||null;

    function renderGallery(){
      for(let i=1;i<=MAX_IMAGES;i++){
        const img=document.createElement('img');
        img.src=`${i}.png`;
        img.alt=`Page ${i}`;
        const card=document.createElement('div');
        card.className='card';
        const cap=document.createElement('div');
        cap.className='caption';
        cap.textContent=`Page ${i}`;
        card.appendChild(img);
        card.appendChild(cap);
        card.addEventListener('click',()=>openLightbox(i));
        galleryEl.appendChild(card);
      }
    }

    function openLightbox(i){
      currentImage=i;
      lightboxImg.src=`${i}.png`;
      commentHeader.textContent=`Comments â€” Page ${i}`;
      renderComments();
      lightbox.classList.add('visible');
    }
    function closeLightbox(){lightbox.classList.remove('visible')}

    lightbox.addEventListener('click',(e)=>{
      if(e.target===lightbox) closeLightbox();
    });

    function renderComments(){
      const all=JSON.parse(localStorage.getItem('pusheen_comments')||'{}');
      const list=all[currentImage]||[];
      commentList.innerHTML='';
      list.forEach(c=>{
        const div=document.createElement('div');
        div.className='comment';
        div.innerHTML=`<div class=\"author\">${c.user}</div><div class=\"text\">${c.text}</div>`;
        commentList.appendChild(div);
      });
    }

    postBtn.onclick=()=>{
      if(!currentUser){alert('Please sign in first!');return;}
      const text=commentText.value.trim();
      if(!text) return;
      let all=JSON.parse(localStorage.getItem('pusheen_comments')||'{}');
      if(!all[currentImage]) all[currentImage]=[];
      all[currentImage].push({user:currentUser,text});
      localStorage.setItem('pusheen_comments',JSON.stringify(all));
      commentText.value='';
      renderComments();
    };

    signinBtn.onclick=()=>{loginModal.classList.add('visible')};
    logoutBtn.onclick=()=>{currentUser=null;localStorage.removeItem('pusheen_user');updateAuth()};
    loginBtn.onclick=()=>{
      const name=usernameInput.value.trim();
      if(!name) return;
      currentUser=name;
      localStorage.setItem('pusheen_user',name);
      loginModal.classList.remove('visible');
      usernameInput.value='';
      updateAuth();
    };

    function updateAuth(){
      if(currentUser){
        signinBtn.style.display='none';
        logoutBtn.style.display='inline-block';
      } else {
        signinBtn.style.display='inline-block';
        logoutBtn.style.display='none';
      }
    }

    renderGallery();
    updateAuth();
  </script>
</body>
</html>
